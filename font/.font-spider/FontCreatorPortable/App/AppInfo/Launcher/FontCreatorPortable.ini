[Launch]
ProgramExecutable=FontCreator\FontCreator.exe
DirectoryMoveOK=yes

[Activate]
Registry=true

[FileWrite1]
Type=Replace
File=%PAL:DataDir%\settings\HKCU.reg
Find=%PAL:LastDrive%\\
Replace=%PAL:Drive%\\

[FileWrite2]
Type=Replace
File=%PAL:DataDir%\settings\HKCU.reg
Find=%PAL:LastPackagePartialDir:DoubleBackslash%
Replace=%PAL:PackagePartialDir:DoubleBackslash%

[RegistryKeys]
HKCU=HKCU\Software\High-Logic\FontCreator
HKLM=HKLM\SOFTWARE\High-Logic\FontCreator
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{10B3EDD8-1FB3-44F6-AB91-93A1BB938357}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\FontInstaller.dll
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{10B3EDD8-1FB3-44F6-AB91-93A1BB938357}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{63560240-BB5D-4F81-B0B9-AEBEA2FE3DD5}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FontInstaller.FontInstallerObject
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Interface\{EF6872F7-17CC-452B-AC7D-E9737A66B570}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\otffile\shellex\ContextMenuHandlers\{63560240-BB5D-4F81-B0B9-AEBEA2FE3DD5}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttcfile\shellex\ContextMenuHandlers\{63560240-BB5D-4F81-B0B9-AEBEA2FE3DD5}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttffile\shellex\ContextMenuHandlers\{63560240-BB5D-4F81-B0B9-AEBEA2FE3DD5}
-=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TypeLib\{420DC907-A73A-483A-B667-20957DD778BE}

[RegistryValueWrite]
HKLM\SOFTWARE\High-Logic\FontCreator\Path=REG_SZ:%PAL:AppDir%\FontCreator
HKLM\SOFTWARE\High-Logic\FontCreator\Settings\Path=REG_SZ:%PAL:AppDir%\FontCreator

[DirectoriesMove]
FontCreator=%APPDATA%\FontCreator

[RegistryCleanupIfEmpty]
1=HKCU\Software\High-Logic
2=HKLM\SOFTWARE\High-Logic
3=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\{10B3EDD8-1FB3-44F6-AB91-93A1BB938357}
4=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\AppID\FontInstaller.dll
5=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{10B3EDD8-1FB3-44F6-AB91-93A1BB938357}
6=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\CLSID\{63560240-BB5D-4F81-B0B9-AEBEA2FE3DD5}
7=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\FontInstaller.FontInstallerObject
8=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Interface\{EF6872F7-17CC-452B-AC7D-E9737A66B570}
9=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\otffile\shellex\ContextMenuHandlers\
10=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttcfile\shellex\ContextMenuHandlers\
11=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\ttffile\shellex\ContextMenuHandlers\
12=HKEY_LOCAL_MACHINE\SOFTWARE\Classes\TypeLib\{420DC907-A73A-483A-B667-20957DD778BE}